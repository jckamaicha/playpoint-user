import{u as A,R as l,b as O,j as e,a,Q as p}from"./js/index.js";import{a as g}from"./axios.js";import{P as W,l as h}from"./loading.js";const D=i=>{var r=g.post("https://api.playpoint.ai/api/v1/authenticate",i);return r},E=async i=>{var r=await g.post("https://api.playpoint.ai/api/v1/verify",i);return r},U=i=>{var r=g.post("https://api.playpoint.ai/api/v1/otplogin",i);return r},J=()=>{const i=A(),[r,v]=l.useState(!1),[f,y]=l.useState(""),[c,C]=l.useState("");l.useState(-1);const[k,w]=l.useState(!1),[S,P]=l.useState(""),[,b]=O(),[N,d]=l.useState(!1),_=new W("e6640b48a82cccbb13d0",{cluster:"ap2"});l.useEffect(()=>{_.connection.bind("connected",function(){console.log("Weboscket Connected")})},[]);const x=t=>/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(t)?!0:(p("You have entered an invalid email address!",{type:"error"}),!1),I=async()=>{d(!0),x(c)&&await D({email:c}).then(t=>{p(t.data.msg),String(t.data.msg).trim()!="You have just reqested for the OTP. please verify or try after a moment"&&(console.log(t.data.msg),P(t.data.variant),v(!0))}),d(!1)},T=async()=>{d(!0);let t=f.trim();S=="0"&&await E({email:c,token:t}).then(n=>{p(n.data.msg),n.data.msg.trim()!="Invalid Token"&&(w(!0),_.subscribe(`verifiction-${c}`).bind("verified",async s=>{console.log(s);const u={userPublicAddress:"",isWalletConnected:!0,username:"",network:"shasta"};localStorage.setItem("userToken",s.token),u.isWalletConnected=!0,u.username=s._newUser.username,u.userPublicAddress=s._wallets.wallets[0]?.address,u.network="arbitrum",localStorage.setItem("rpcUserData",JSON.stringify(u)),localStorage.setItem("isNonWalletUser",!0),localStorage.setItem("rpcUserWallets",JSON.stringify(s._wallets.wallets));const m=new Date;m.setTime(m.getTime()+6*60*60*1e3),localStorage.setItem("rpcUserExpiresAt",m),b({type:"wallet-connect",payload:u}),d(!1),i("/"),w(!1)}))}),S=="1"&&await U({email:c,token:t}).then(async n=>{if(n.data?.msg?.trim()!="Invalid OTP"){const o={userPublicAddress:"",isWalletConnected:!0,username:"",network:"shasta"};localStorage.setItem("userToken",n.data.accessToken),o.isWalletConnected=!0,o.username=n.data._user.username,o.userPublicAddress=n.data._wallet.wallets[0]?.address,o.network="arbitrum",localStorage.setItem("rpcUserData",JSON.stringify(o)),localStorage.setItem("rpcUserWallets",JSON.stringify(n.data._wallet.wallets)),localStorage.setItem("isNonWalletUser",!0);const s=new Date;s.setTime(s.getTime()+6*60*60*1e3),localStorage.setItem("rpcUserExpiresAt",s),console.log("dispatchingg"),b({type:"wallet-connect",payload:o}),d(!1),i("/")}}).catch(n=>{n.response&&(p(n.response.data.msg),d(!1))})};return e("div",{className:"signin__container",children:a("div",{className:"wrapper",children:[a("div",{className:"signinhero__container",children:[e("h1",{children:"Welcome to our Community"}),e("p",{children:"A whole new productive journey starts right here"})]}),e("div",{className:"signinform__container",children:k?a("div",{children:[e("img",{src:h,alt:"loader"}),e("p",{children:"Setting up your account"})]}):r?a("div",{className:"otp__container",children:[a("div",{className:"title",children:[e("h3",{children:"OTP Verification"}),a("p",{children:["Enter OTP sent to ",c]})]}),e("div",{className:"boxes",children:e("div",{className:"box",children:e("input",{placeholder:"Enter Code",type:"text",maxLength:6,name:"input-otp",value:f,onChange:t=>{y(t.target.value)},inputMode:"numeric",autoComplete:"one-time-code"})})}),a("p",{className:"resend",children:["Didn't receive OTP ?"," ",e("span",{onClick:()=>{v(!1),y("")},children:"Resend OTP"})]}),e("button",{onClick:()=>T(),children:e("p",{children:N?e("img",{src:h}):"Confirm OTP"})})]}):a("div",{className:`signin__form ${r?"active":""}`,children:[a("div",{className:"item",children:[e("div",{children:"📥️ Email"}),e("input",{type:"email",placeholder:"Enter your email address",onChange:t=>C(t.target.value)})]}),a("div",{className:"recovery",children:[a("div",{className:"checkbox_container",children:[e("input",{type:"checkbox",id:"checkbox"}),e("label",{htmlFor:"checkbox",children:"Keep Me login"})]}),e("p",{children:"Recover Password"})]}),e("button",{onClick:()=>I(),children:N?e("img",{src:h}):"Authenticate"}),a("div",{className:"continue",children:[a("div",{children:[e("span",{}),e("p",{children:"or Continue With"}),e("span",{})]}),e("p",{children:e("i",{className:"ri-google-fill"})})]})]})})]})})};export{J as default};
//# sourceMappingURL=index17.js.map
