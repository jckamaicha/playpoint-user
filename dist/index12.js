import{R as s,j as t,w as U,b as V,a as e,F as B,Q as q}from"./js/index.js";import{b as W,D as z,A as J,T as M,I as X}from"./Prediction.js";import G from"./ERC20BasicABI.js";import{getChallenge as K,mkaeDuo as Z}from"./Challenge.js";import{S as ee}from"./Slide.js";import{B as u}from"./Button.js";import{S as m}from"./Stack.js";import{S as r}from"./Skeleton.js";import{T as I}from"./Typography.js";import{W as te,C as ne}from"./web3-provider.js";import"./styled.js";import"./ButtonBase.js";import"./useForkRef.js";import"./Paper.js";import"./useTheme.js";import"./axios.js";import"./useSlotProps.js";import"./isHostComponent.js";import"./extendSxProp.js";const ie=s.forwardRef(function(a,f){return t(ee,{direction:"up",ref:f,...a})}),xe=()=>{const{pid:v}=U(),[a,f]=s.useState([]),[p,D]=s.useState([]),[_,E]=s.useState([]),[x,w]=s.useState(!0),[k]=V(),[l,T]=s.useState([]),[g,F]=s.useState(""),{userPublicAddress:C,userPPTTBalance:R,userETHBalance:j}=k,[y,Q]=s.useState(!1),[d,A]=s.useState(""),[N,P]=s.useState(!1),[c,$]=s.useState({});s.useEffect(()=>{N||W(v).then(n=>{n.data.data&&(console.log(n.data.data),f(n.data.data[0]),D(n.data.data[1]),w(!1))})},[N,d]),s.useEffect(()=>{d=="watch-challenge"&&(console.log("fetching"),K(l).then(n=>{console.log(n.data),$(n.data)}))},[d]),s.useEffect(()=>{w(!0);let n=JSON.parse(sessionStorage.getItem("predictions"));n&&(n=n.filter(i=>{if(i.predictedBy===C&&i._id!==v)return i}),E(n),w(!1))},[C]);const O=(n,i)=>{T(n),A(i),P(!0)},H=(n,i)=>{A(n),P(!0),T(i)},S=()=>{P(!1)},L=n=>{F(n._id)},b=async()=>{q("Challenging..",{type:"info"});const n=new te(ethereum),i=new ne("0x53d168578974822bCAa95106C7d5a906BF100948",G,n).connect(n.getSigner()),h=l.amount>10?toFixed(l.amount/.02*10**18):(l.amount/.02*1e18).toString();console.log(h);const o=await i.transfer({}.VITE_BETA_FACTORY_CONTRACT_ADDRESS,h),Y={predictionId:l.predictionId,type:l.type,participants:{prediction:g,txnhash:o.hash}};(await Z(Y)).status==201&&(q("Challenge Created",{type:"success"}),S())};return e(B,{children:[e("div",{className:"userprediction_container",children:[a.user&&!x?e("div",{className:"container",children:[e("div",{className:"profile_area",children:[t("img",{src:`https://robohash.org/${a.user[0].username||"aa"}`,loading:"lazy"}),t("h3",{children:t("a",{href:"#",children:a.user[0].username})}),e("p",{children:[" ",e(B,{children:[`${a.user[0].walletID}`.substring(0,15)+"..."+`${a.user[0].walletID}`.substring(a.user[0].walletID.length-3)," ",t("i",{className:"ri-arrow-right-up-line"})]})]}),e("p",{children:["Prediction Amount: $",a.amount," ~"," ",a.amount/.02,"PPTT"]})]}),e("div",{className:"answers_area",children:[e("div",{children:[e("span",{children:["Pool: ",p.poolType]}),e("span",{children:["Price: ",p.questionairePrice]})]}),t("h1",{children:"Questions & Answers"}),t("div",{className:"questions",children:p?.questionaires?.questions.map((n,i)=>e("div",{className:"question_answer",children:[e("h4",{children:["Q",i+1,". ",n,e("span",{children:[p?.questionaires?.points[i]," Points"]})]}),e("p",{children:["Answer: ",a.answers[i]]})]},i))}),t("div",{className:"btn_area",children:a.challenges.map((n,i)=>e("div",{className:"pool_info",children:[e("p",{children:["Pool Type: ",String(n.type).toLocaleUpperCase()]}),e("p",{children:["Total Slot: ",n.slot]}),e("p",{children:["Pool Entry Amount: ",n.amount/.02,"PPTT"]}),t("p",{children:a.predictedBy!==C?n.participants.length<n.slot?e(u,{variant:"outlined",color:"secondary",onClick:()=>O(n,"challenge"),children:["Challenge ",n.participants.length," of"," ",n.slot]}):t("p",{children:"All Slots Full "}):t(u,{variant:"outlined",color:"error",onClick:()=>H("watch-challenge",n._id),children:"View Challenge"})})]},i))})]})]}):e("div",{className:"skeleton__container__predictions",children:[t("div",{className:"profile_area",children:e(m,{spacing:1,children:[t(r,{variant:"rectangular",width:200,height:100}),t(r,{variant:"rectangular",width:70,height:20}),t(r,{variant:"rectangular",width:160,height:20}),t(r,{variant:"rectangular",width:210,height:20})]})}),e("div",{className:"answer_area",children:[e(m,{spacing:0,children:[t(r,{variant:"text",component:"p",width:200,height:40}),t(r,{variant:"text",component:"h1",width:300,height:50}),[0,1].map((n,i)=>e(m,{children:[t(r,{variant:"text",component:"h1",width:500,height:50,className:"question"}),t(r,{variant:"text",component:"h4",width:800,height:50,className:"points"}),t(r,{variant:"text",component:"p",width:100,height:50,className:"answer"})]},i))]}),e(m,{sx:{display:"flex",flexDirection:"row",gap:"70px"},children:[t(r,{variant:"rectangular",width:100,height:40}),t(r,{variant:"rectangular",width:100,height:40}),t(r,{variant:"rectangular",width:200,height:40}),t(r,{variant:"rectangular",width:200,height:40})]})]})]}),t("div",{className:"divider"}),e("div",{className:"other_prediction__container",children:[t("h2",{children:"Your Predictions in same pool"}),x?t("div",{className:"otherpredictionskeleton__container",children:t("div",{className:"otherpredictions",children:[0,1,2,3].map((n,i)=>t("div",{children:[0,1,2].map((h,o)=>e(m,{spacing:1,sx:{marginBottom:"1em"},children:[t(r,{variant:"rectangular",width:550,height:30}),t(r,{variant:"rectangular",width:100,height:30})]},o))},i))})}):t("div",{className:"otherpredictions",children:_.length>0?_.map((n,i)=>t("div",{children:t("div",{className:"otherpredictions_box",children:p?.questionaires?.questions.map((h,o)=>e("div",{className:"question_answer",style:{margin:"1.2em 0"},children:[e("h4",{children:["Q",o+1,". ",h]}),e("p",{children:["Answer: ",n.answers[o]]})]},o))})},i)):e("div",{children:[t("h3",{children:"Looks like you have only 1 or no entries in this pool"}),t("a",{href:`/predict/${a.fixtureId}`,className:"pp_button",children:"Predic Now"})]})})]})]}),a&&a.user&&e(z,{fullScreen:!0,open:N,onClose:S,TransitionComponent:ie,color:"white",className:"custom-paper",children:[t(J,{sx:{position:"relative",backgroundColor:"black"},children:e(M,{children:[t(X,{edge:"start",color:"inherit",onClick:S,"aria-label":"close",children:"X"}),d=="challenge"&&t(I,{sx:{ml:2,flex:1},variant:"h6",component:"div",children:a.user&&"Challenge "+a?.user[0]?.username+"-"+l.type}),d=="watch-challenge"&&t(I,{sx:{ml:2,flex:1},variant:"h6",component:"div",children:"Your Challenge Pools"})]})}),d=="challenge"&&e("div",{children:[e("h2",{className:"dialog__title",children:["Select your entry to challenge"," ",a?.user[0]?.username]}),e("div",{className:"predictions__container",children:[e("div",{className:"predictions",onClick:()=>Q(!0),children:[_.map((n,i)=>t("div",{style:{border:"0.2px solid white",padding:"10px",cursor:"pointer"},onClick:()=>L(n),className:g==n._id?"selected":"",children:t("div",{children:p?.questionaires?.questions.map((h,o)=>e("div",{className:"question_answer",style:{margin:"1.2em 0"},children:[e("h4",{children:["Q",o+1,". ",h]}),e("p",{children:["Answer: ",n.answers[o]]})]},o))})},i)),y&&t("div",{className:"floatingButton__container",children:t(u,{variant:"contained",children:"Challange"})})]}),g&&e("div",{className:"activePrediction__container",children:[t("h4",{children:"Selected Entry"}),t("hr",{}),e("p",{children:["Entry ID: ",t("span",{children:g})," "]}),e("p",{children:["Challenge Entry Amount:"," ",e("span",{children:[l.amount/.02,"PPTT"]})]}),e("p",{children:["Available Assets:"," ",e("span",{children:[parseFloat(j).toFixed(2)," ETH"," ",parseFloat(R).toFixed(2)," PPTT"]})]}),t(u,{variant:"outlined",onClick:()=>b(),children:"Challenge"})]})]}),y&&t("div",{className:"floatingButton__container",children:t(u,{variant:"contained",onClick:()=>b(),children:"Challange"})})]}),d=="watch-challenge"&&c._id?e("div",{className:"challenege_status_container",children:[e("h3",{children:["Challenge ID: #",c._id.slice(-10,c._id.length)]}),e("div",{className:"csc__Header",children:[e("p",{children:["No of slots: ",c.slot]}),e("p",{children:["Intra Pool: ",c.type]}),e("p",{children:["Pool status: ",c.status]}),e("p",{children:["Filled: ",c.participants.length]})]}),e("div",{className:"csc__Content",children:[c.participants.map((n,i)=>{}),t("div",{className:"card"})]})]}):t("h3",{children:"Looks like you have no entries in the pool of "})]})]})};export{xe as default};
//# sourceMappingURL=index12.js.map
